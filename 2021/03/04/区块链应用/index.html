<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>区块链应用 | 魏洁杨</title><link rel="shortcut icon" href="/images/logo.svg"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/css/font-awesome.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"jieyang-wei.github.io",root:"/",path:"search.json"},KEEP.theme_config={toc:{enable:!0,number:!0,expand_all:!0},style:{primary_color:"#0066CC",avatar:"/images/avatar.jpg",favicon:"/images/logo.svg",img_position:"left",left_side_width:"260px",content_max_width:"900px",hover:{shadow:!0,scale:!0},first_screen:{enable:!0,background_img:"/images/bg.svg",description:"Welcome to Wei jieyang's Blog"}},local_search:{enable:!0,trigger:"auto",unescape:!1,preload:!0},version:"3.0.4"},KEEP.language={search:"Search...",prev:"Prev",next:"Next",prev_posts:"Prev posts",next_posts:"Next posts",page:"Page %d",recent_posts:"Recent Posts",share:"Share",powered_by:"Powered by %s",theme:"Theme",rss_feed:"RSS Feed",category:"Category",categories:"Categories",tag:"Tag",tags:"Tags",tagcloud:"Tag Cloud",comment:"Comment",home:"Home",archive:"Archive",archives:"Archives",about:"About",site_uv:"Visitor Count",site_pv:"Totalview",links:"Links",link:"Link",top:"TOP",read_more:"Read more",wordcount:"Words",min2read:"Mins",changelog:"Changelog",copyright:{author:"Post author",title:"Post title",link:"Post link",create_time:"Create time",license_title:"Copyright Notice",license_content:"All articles in this blog are licensed under %s unless stating additionally."},ago:{second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days age",week:"%s weeks age",month:"%s months age",year:"%s years age"}}</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="WeiJY's blog" type="application/atom+xml"></head><body><div class="page-container"><header class="page-header"><div class="header-progress"></div></header><main class="page-main"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><a class="logo-title" href="/">魏洁杨</a><ul class="menu-list"><li class="menu-item"><a href="/">HOME</a></li><li class="menu-item"><a href="/categories">CATEGORIES</a></li><li class="menu-item"><a href="/categories/notebook">NOTEBOOK</a></li><li class="menu-item"><a href="/about">ABOUT</a></li><li class="menu-item"><a href="/tags">TAGS</a></li></ul><div class="menu-bar"><div class="menu-bar-middle"></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">HOME</a></li><li class="drawer-menu-item flex-center"><a href="/categories">CATEGORIES</a></li><li class="drawer-menu-item flex-center"><a href="/categories/notebook">NOTEBOOK</a></li><li class="drawer-menu-item flex-center"><a href="/about">ABOUT</a></li><li class="drawer-menu-item flex-center"><a href="/tags">TAGS</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle"><main class="main-content normal-code-theme"><div class="fade-in-down-animation"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">区块链应用</span></div><div class="article-header"><div class="avatar"><img src="/images/avatar.jpg"></div><div class="info"><div class="author"><span>Wei Jieyang</span> <span class="level">Lv2</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fas fa-calendar"></i> 2021-03-04 14:48:09 </span><span class="article-categories article-meta-item"><i class="fas fa-folder"></i><ul><li><a href="/categories/notebook/">notebook</a></li></ul></span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i><ul><li><a href="/tags/distributed-system/">distributed system</a></li><li>| <a href="/tags/blockchain/">blockchain</a></li><li>| <a href="/tags/BTC/">BTC</a></li><li>| <a href="/tags/Ethereum/">Ethereum</a></li></ul></span><span class="article-wordcount article-meta-item"><i class="fas fa-file-word"></i> <span>9.2k Words</span> </span><span class="article-min2read article-meta-item"><i class="fas fa-clock"></i> <span>33 Mins</span> </span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i> <span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body"><h1 id="crypto-currency，加密货币"><a href="#crypto-currency，加密货币" class="headerlink" title="crypto-currency，加密货币"></a>crypto-currency，加密货币</h1><ul><li><p>区块链是一种数据结构，而比特币和以太坊都是使用区块链这种数据结构实现的应用</p></li><li><p><a class="link" target="_blank" rel="noopener" href="https://bitcoin.org/bitcoin.pdf">比特币白皮书<i class="fas fa-external-link-alt"></i></a></p></li><li><p><a class="link" target="_blank" rel="noopener" href="https://www.cnblogs.com/coderzjz/p/13788649.html">别人好的笔记<i class="fas fa-external-link-alt"></i></a></p></li></ul><h1 id="比特币-BTC"><a href="#比特币-BTC" class="headerlink" title="比特币 BTC"></a>比特币 BTC</h1><p><strong>前提：</strong>大部分算力掌握在诚实的矿工手里</p><h2 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h2><h3 id="1-crypto-graphic-hash-function"><a href="#1-crypto-graphic-hash-function" class="headerlink" title="1. crypto graphic hash function"></a>1. crypto graphic hash function</h3><p>特性：</p><ol><li><p>collision resistance：抗碰撞性</p></li><li><p>hiding：x可以算出H(x)，但H(x)不能反推出x，即这个hash函数不会泄露x</p><ul><li><p>需要满足，不然可以通过蛮力求解</p><ol><li><p>输入空间大</p></li><li><p>均匀分布</p></li></ol></li><li><p>digital commitment / digital equivalent of a sealed envelope：密封预测结果</p></li></ul></li><li><p>puzzle friendly：H(x)是事先不可预测的</p></li></ol><p>H(block header) &lt;= target 目标域值（nBits：目标域值编码）</p><p>proof of work POW，工作证明</p><p>difficult to solve, but easy to verify</p><h3 id="2-签名"><a href="#2-签名" class="headerlink" title="2. 签名"></a><strong>2. 签名</strong></h3><p>账户 - public key, private key</p><ul><li>来源于非对称加密：asymmetric encryption algorithm</li><li>最早期是对称加密，symmetric encryption algorithm，但这样密钥分发是一个问题，所以有了公私钥</li></ul><p>a good source of randomness：使得生成的公钥相同的几率微乎其微</p><p><strong>SHA-256</strong>（Secure Hash Algorithm）</p><ul><li><a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/u011583927/article/details/80905740">原理简介<i class="fas fa-external-link-alt"></i></a></li><li>和md5加密的效果一样，但是SHA-256更加的安全</li><li>都只能算是签名，加密算法是既能加密也能解密的算法，而签名就仅仅是起到校验和的作用</li></ul><hr><p>Mac, Linux hash命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> md5 file.txt    <span class="comment"># md5校验和</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> shasum -a 1 /tmp/hello.txt      <span class="comment"># SHA-1校验和</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> shasum -a 256 /tmp/hello.txt    <span class="comment"># SHA-256校验和</span></span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> -a --algorithm</span></span><br></pre></td></tr></table></figure><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/截屏2020-12-27 上午10.44.14.png" alt="截屏2020-12-27 上午10.44.png" style="zoom:60%"><hr><h2 id="BTC-数据结构"><a href="#BTC-数据结构" class="headerlink" title="BTC 数据结构"></a>BTC 数据结构</h2><blockquote><p>区块链仅仅是一个<strong>数据结构</strong>，BTC是使用区块链这种数据结构实现的应用</p></blockquote><h3 id="hash-point"><a href="#hash-point" class="headerlink" title="hash point"></a>hash point</h3><ul><li>无环链表都可以用 hash point 代替普通的point</li></ul><ol><li>区块链</li></ol><p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_0230-7744726.jpg" alt="IMG_0230"></p><ul><li><p>block chain is a linked list using hash pointers：用hash point 代替普通的指针</p><ul><li><p>genesis block：创世区块 most recent blcok：最近产生的区块</p><p>H( )：hash point</p></li><li><p>tamper-evident log：最后一个hash值就能检查整个链表是否被修改过</p></li></ul></li></ul><blockquote><p>Merkle tree 不是区块链的信息存储结构，而是BTC使用过程中用到的数据结构，在节点验证交易正确性时，使用到的一个结构而已</p></blockquote><ol start="2"><li>Merkle tree<ul><li>与binary tree的区别<ol><li>用hash point代替普通的指针</li><li>只要记录<code>root hash</code>，就能检测对整棵树的修改</li></ol></li><li>block header：只保存<code>root hash</code>，</li><li>block body：保存所有的交易信息<code>tx</code>等</li><li>作用：<ul><li>提供<code>merkle proof</code></li></ul></li></ul></li></ol><blockquote><p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_231E499E57D8-1.jpeg" alt="IMG_231E499E57D8-1"></p><ul><li><strong>proof of membership</strong>：轻节点想知道黄色交易是否在<code>merkle tree</code>上，只有一个<code>root hash</code>(在<code>block header</code>里面)</li></ul><ol><li>轻节点向某个全节点发出证明请求，请求一个能证明黄色交易包括在<code>merkle tree</code>里面的一个<code>merkle proof</code></li><li>全节点收到请求，会将图中红色的三个<code>hash值</code>发送给这个轻节点</li><li><strong>从下往上</strong>：轻节点会算出黄色交易的hash值绿1，绿1和红1一起算出hash值绿2，绿2和红2算出绿3，绿3和红3一起算出<code>root hash</code></li><li>轻节点比较这个算出来的<code>root hash</code>和<code>block header</code>的hash值</li></ol><blockquote><p><strong>注意</strong>：我们只能验证绿色的部分，不能验证红色部分的hash值</p></blockquote><blockquote><ul><li>如果考虑通过调整红色的部分，使得被篡改后的绿色的部分算出来hash不变，是不实际的</li><li>因为<code>Collision resistance</code>性质，这样的操作相当于人为的制造hash碰撞</li></ul></blockquote><ul><li><strong>proof of non-memership</strong>：轻节点想证明某个交易不存在</li></ul><ol><li></li></ol></blockquote><h2 id="数字货币"><a href="#数字货币" class="headerlink" title="数字货币"></a>数字货币</h2><ul><li>使用公私钥，非对成加密算法<ol><li>Double spending attack，双花攻击 - 花两次攻击：数字货币本质上是一个文件，带签名的数字货币可以复制</li></ol></li><li>每个数字货币上带编号（防范DSA，但是是中心化的）<ul><li>bank维护一个数据库，每个编号的数字货币在谁手里</li><li>每次验证数字货币的签名和编号，这个货币有没有发过，被谁花过</li></ul></li></ul><p><strong>BTC安全性</strong></p><ol><li><strong>密码学</strong>：别人没有私钥，不能伪造签名<ul><li>前提：系统中拥有大多数算力的矿工是好的，是遵守协议的，不会接受没有合法签名的交易</li></ul></li><li><strong>共识机制</strong>：</li></ol><h3 id="BTC解决去中心化的数字货币发行问题"><a href="#BTC解决去中心化的数字货币发行问题" class="headerlink" title="BTC解决去中心化的数字货币发行问题"></a>BTC解决去中心化的数字货币发行问题</h3><ul><li><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_9CCCEC7F3445-1.jpeg" alt="IMG_9CCCEC7F3445-1"><ul><li>交易中A的公钥表明是钱是哪儿来的，但是要将A和他的公钥联系在一起，不然E可以用自己的公钥冒充A的，再用自己的私钥签名<ul><li><strong>coinbase tx</strong>：需要验证A-&gt;B的钱的前一个交易（金币来源）中A的公钥，即金币来源的输出脚本，和交易中提供的A的公钥，即交易的输入脚本拼在一起合成一个程序，看能不能顺利执行</li></ul></li></ul></li></ul><h4 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h4><h5 id="区块结构"><a href="#区块结构" class="headerlink" title="区块结构"></a>区块结构</h5><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_9EF94BC347FE-1.jpeg" alt="IMG_9EF94BC347FE-1" style="zoom:70%"><ul><li><strong>Block Header</strong><ul><li>区块信息：<ul><li>version：比特币版本</li><li>时间戳等</li></ul></li><li>hash of previous block header：指向前一个区块的指针（只算header的hash）<ul><li>创世区块的<code>previous hash</code>为0</li></ul></li><li>merkle root hash：整棵merkle tree的根hash值<ul><li>保证了<code>transaction list</code>是无法被篡改的</li></ul></li><li>nonce：随机数，256bits<ul><li>target：挖矿难度目标域值</li></ul></li></ul></li><li><strong>Block Body</strong><ul><li>transaction list</li><li>只存交易信息</li></ul></li></ul><h5 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h5><ul><li>full node（fully validating node，全节点）：</li><li>light node（light weight node，轻节点）：<ul><li>一般无法验证交易的合法性，只是利用区块链的信息做一个查询</li></ul></li></ul><h4 id="Consensus-in-BitCoin，比特币共识"><a href="#Consensus-in-BitCoin，比特币共识" class="headerlink" title="Consensus in BitCoin，比特币共识"></a>Consensus in BitCoin，比特币共识</h4><p>distributed consensus，分布式共识</p><ul><li>impossibility result：<ul><li>FLP：在一个异步的系统里（asynchronous），网络时延没有上线，哪怕系统中只要有一个用户是faulty的，都没有办法达成共识</li><li>CAP Theorem：以下三个性质中，最多满足两种<ul><li>一致性Consistency、可用性Availability、分区容错性Partition tolerance</li></ul></li></ul></li></ul><p>membership</p><p>hyperledger</p><p>联盟链 - fabric</p><p>sybil attacl，女巫攻击：找一个超级计算机，不停的产生用户节点，当总数超过一半时，就得到了这个链的控制权</p><ul><li>coinbase transaction：<ul><li>coinbase域：可以在里面写东西，永久保存，但只有获得记账权的节点才能使用</li><li>通过算例投票 puzzle friendly</li><li>hash rate</li><li>nonce</li></ul></li></ul><p>mining - 挖矿：比特币争夺记账权</p><ul><li>digital gold</li><li>miner</li></ul><h4 id="BTC系统实现"><a href="#BTC系统实现" class="headerlink" title="BTC系统实现"></a>BTC系统实现</h4><h5 id="transaction-based-ledger，基于交易的账本模式"><a href="#transaction-based-ledger，基于交易的账本模式" class="headerlink" title="transaction-based ledger，基于交易的账本模式"></a>transaction-based ledger，基于交易的账本模式</h5><ul><li>每个交易需要说清楚，币是从哪儿来的，它没有账户的概念</li></ul><p>全节点维护一个数据结构：</p><ul><li><p>UTXO，unspent Transaction Output：还没有被花掉的交易的输出集合</p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_1019233284AC-1 .jpeg" alt="IMG_1019233284AC-1" style="zoom:50%"><ul><li><strong>包括</strong> 2个数据就能定位UTXO的输出：<ol><li>产生这个输出的交易的hash 值</li><li>这个输出是交易中的第几个输出</li></ol></li><li><strong>作用</strong>：检测Double Spending<ul><li>total inputs = total outputs：i可以略大于o，中间的<code>transaction fee</code>可能给了拥有记账权的区块</li><li>transaction fee：大约只有零点零几个币</li></ul></li></ul></li></ul><p>account-based ledger，基于账户的模式</p><ul><li>系统需要显示的记录每个账户有多少个币，如以太坊ß</li></ul><h5 id="Bernoulli-trial"><a href="#Bernoulli-trial" class="headerlink" title="Bernoulli trial"></a>Bernoulli trial</h5><ul><li><p>a random experiment with binary outcome</p></li><li><p>每次求解nonce可以看作是Bernoulli trial</p></li></ul><p><strong>Bernoulli process</strong>：a sequence of independent Bernoulli</p><ul><li>大量实践的Bernoulli trial就组成了</li><li>性质：<ul><li>memoryless，无记忆的：实验结果和之前的实验结果是没有关系的</li></ul></li></ul><p>Poisson process：</p><p>exponential distribution，出块时间：服从指数分布</p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_9A528FE35443-1.jpeg" alt="IMG_9A528FE35443-1" style="zoom:40%"><ul><li>无记忆性：<ul><li>memory less：将来挖多少时间与之前已经挖了多少时间没有关系，即使等了10mins，下一挖到矿的时间仍然指数分布，平均是10mins</li><li>process free：过去的process是没用的，对挖矿公平性的保证</li></ul></li></ul><p>出块奖励</p><p>geometric series 几何级数</p><ul><li>BTC总数：21万 * 50 + 21万 * 25 + 21万 * 12.5 + ····<ul><li>= 21万 * 50 *（1 + 1/2 + 1/4 + ····）[等比求和，逐年减半]</li><li>= 2100万 [过去到未来的BTC总数]</li></ul></li></ul><p>Bitcoin is secured by mining</p><p>分岔攻击</p><p>回滚交易 - Double Spending Attack</p><ul><li>多等几个区块/确认 confirmation</li></ul><p>irrevocable ledger，不可篡改的账本</p><ul><li>不可篡改是该旅行的保证</li></ul><p>zero confirmation</p><ul><li>交易刚发出去，没有写进区块</li></ul><p>selfish mining</p><ul><li>我先不发布，等到挖到足够多的区块了，再一起发布，盖过其他的 - 分岔攻击</li><li>自己挖到两个的时候，不发布，等别人挖到一个，再一起发布，别人的那个就白发了</li><li>风险：<ul><li>不一定抢的赢别人</li></ul></li></ul><h4 id="BTC网络"><a href="#BTC网络" class="headerlink" title="BTC网络"></a>BTC网络</h4><p>BTC所有节点平等，没有super/master node</p><p>协议：</p><ul><li>application layer：BitCoin Block chain</li><li>network layer：P2P Overlay Network</li></ul><p>设计原则：simple简单，robot鲁棒，but not efficient不是高效</p><ul><li><p>消息节点：flooding方式</p></li><li><p>邻居节点：选取是随机的，不考虑底层的拓扑结构</p><ul><li>增强了鲁棒性，但是牺牲了效率</li></ul></li><li><p>每个节点维护一个等待上链的消息集合</p><ul><li>冲突交易</li></ul></li></ul><p>best effort，</p><blockquote><p>区块链是一种数据结构，而节点是在基于网络应用时，每一个连入区块的设备，比如手机就是轻节点，而矿池(后面有讲)就是一个全节点，保存所有的信息 - 现在BTC大约有100多G</p></blockquote><p><strong>全节点</strong>：保存所有的信息</p><ul><li>一直在线</li><li>在本地硬盘上维护完整的区块链信息</li><li>在内存里维护UTXO集合，以便快速检验交易的正确性</li><li>监听比特币网络上的交易信息，验证每个交易的合法性</li><li>决定哪些交易会被打包到区块里</li><li>监听别的矿工挖出来的区块，验证其合法性</li><li>挖矿：<ul><li>决定沿着那条链挖下去<ul><li>缺省情况下选择最长的链</li></ul></li><li>当出现等长的分岔的时候，选择哪一个分岔<ul><li>缺省情况下选择第一个发现的</li></ul></li></ul></li></ul><p><strong>轻节点</strong>：只保存block header（如手机上）</p><ul><li>不是一直在线</li><li>不用保存整个区块链，只要保存每个区块的块头</li><li>不用保存全部交易，只保存与自己相关的交易</li><li>无法检测大多数交易的合法性，只能检验与自己相关的那些交易的合法性</li><li>无法检测网上发布的区块的正确性<ul><li>因为无法知道区块里的交易是不是合法的</li></ul></li><li>可以验证挖矿的难度<ul><li>挖矿时计算hash值只需要用到块头的信息</li></ul></li><li>只能检测那个是最长的链，不知道哪个是最长的合法链<ul><li>只能知道这个链上的区块挖矿难度时符合要求的，但是无法验证每个区块里交易的合法性</li></ul></li></ul><h2 id="挖矿"><a href="#挖矿" class="headerlink" title="挖矿"></a>挖矿</h2><p>H(block header) &lt;= target</p><ul><li>target越小，难度越大</li><li>需要调整target值，使得出块时间保持稳定（BTC大约为10mins）</li></ul><p>hash算法：SHA-256</p><ul><li>取值空间：2^256</li><li>block header里面存nBits，只有4字节<ul><li>target有256位，32字节</li></ul></li></ul><h3 id="挖矿难度"><a href="#挖矿难度" class="headerlink" title="挖矿难度"></a>挖矿难度</h3><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_3A7CCA25FE75-1.jpeg" alt="IMG_3A7CCA25FE75-1" style="zoom:50%"><ul><li>difficulty_1_target：挖矿难度等于1时的目标域值</li><li>1是最低难度</li><li>不调整target的话，出块时间会越来越短<ul><li>分岔，几个用户同时出块</li><li>系统不容易统一</li><li>51% attack：将大部分算力用来放在攻击的回滚区块的链上</li></ul></li></ul><p>orphan block</p><p>uncle reward</p><h3 id="难度调整"><a href="#难度调整" class="headerlink" title="难度调整"></a>难度调整</h3><p>每2016个区块调整目标域值，大约为2周（2016 * 10 / 60 * 24 = 14）</p><ul><li>调整公式：<img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_E4D6502FBD91-1.jpeg" alt="IMG_E4D6502FBD91-1" style="zoom:40%"><ul><li>如果实际时间超过了2周，那么平均出块时间超过了10mins，这个时候出块难度需要调整的低一点（右边分式大于1，target变大）</li></ul></li><li><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_D3AE8A16D3B4-1.jpeg" alt="IMG_D3AE8A16D3B4-1" style="zoom:70%"></li></ul><h3 id="设备"><a href="#设备" class="headerlink" title="设备"></a>设备</h3><p><strong>早期1代 - CPU</strong>：</p><ul><li>随着挖矿难度增加，性价比极低</li><li>计算机中大部分内存都是闲置的，挖矿只用到了其中很少一部分内存</li><li>大部分不见也是闲置的，挖矿中hash值的计算只用到了通用计算机cpu中很少一部分指令</li><li>硬盘和其他资源也是闲置的</li></ul><blockquote><p>GPU主要用于大规模的并行计算，如深度学习</p></blockquote><p><strong>2代 - GPU</strong>：</p><ul><li>效率得到了很大的提高</li><li>但gpu主要是为了并行计算设计的，其中仍然有很多部件是闲置的，所以也不划算<ul><li>如用于浮点数运算的部件</li></ul></li><li>对于现在的挖矿的难度，GPU的算力已经不够了</li></ul><blockquote><p>ASIC：Application Specific Integrated Circuit</p></blockquote><p><strong>现在 - ASIC芯片</strong></p><ul><li>专门为了BTC挖矿<strong>计算hash值</strong>所设计的，生产周期长（不能做全节点其他工作）</li><li>为某种加密货币设计的芯片，只能挖着一种货币（除非两种货币用同一个mining puzzle）<ul><li>merge mining：一个新的货币发行时，为了解决冷启动问题，吸引更多的用户，故意用一个已有的mining puzzle</li></ul></li><li><strong>Alternative mining puzzle</strong><ul><li>有的货币会设计这种puzzle，达到下面的效果</li><li>ASIC resistance：抗ASIC芯片化，为了让通用CPU也能参与挖矿</li></ul></li></ul><h3 id="矿池"><a href="#矿池" class="headerlink" title="矿池"></a>矿池</h3><ul><li>一个全节点去驱动很多的矿机（一个矿工负责全部的工作比较累）</li></ul><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_FFBC17D6F168-1.jpeg" alt="IMG_FFBC17D6F168-1" style="zoom:60%"><ul><li><p>矿主：其他全节点的指责</p><ul><li>监听网上的交易，将这些交易组织打包成候选区块</li><li>同时关注是否有其他节点抢先发布了区块，如果有就需要作出调整等</li></ul></li><li><p>矿工：只负责计算hash值</p></li><li><p><strong>好处</strong>：</p><ul><li><p>减轻了矿工的工作量</p></li><li><p>解决单个矿工收入不稳定问题，以下两种方式</p><ol><li>像大型数据中心一样，矿池下有成千上万的矿机，属于一个机构，好分配</li><li>分布式，矿机来自不用的厂商，需要通过通讯协议与矿主联系，之后一起分红</li></ol><blockquote><p>如何解决矿工分红问题 - 工作量证明：</p><ul><li>降低挖矿难度，矿工提交 - share，almost valid block - 只能用来证明做了多少工作</li></ul></blockquote></li></ul></li><li><p>大型矿池的<strong>弊病</strong>：使得51%的攻击更加容易了</p><ul><li><strong>分叉攻击</strong>：对已经经过6次确认的交易分叉，利用51%算力将交易记录回滚。<ul><li>矿工只能计算哈希值，并不知道区块包含哪些交易，区块链状况是什么。所以，这些“群众”是无知的，容易被利用（《乌合之众》当中提出的观点，大多数人真的就能掌握真理吗？）。</li><li>此外，51%攻击只是一个概率问题，并非达到51%算力就能发动攻击，不能达到就无法发动攻击。此外，矿池本身算力也是在不断变化的。</li></ul></li><li><strong>封锁交易（Boycott）</strong>：<ul><li>假如攻击者不喜欢某个账户A，不想让A的交易上区块链，在监听到有其他人将A的交易发布到区块链上时，立刻发动分叉攻击，使A所在链无法成为”最长合法链“。这样，便实现了对A账户的封锁。</li><li>像不像即当裁判又当运动员？”堂下何人状告本官“？</li></ul></li><li><strong>盗币</strong>（将他人账户BTC转走）<ul><li>这个是<strong>不可能</strong>的，因为其并没有他人账户私钥。如果依仗算力强，强行将没有签名的转账发布到区块链，正常节点不会认为其合法，这样，即使这条链再长，其他人也不会认为其是最长合法链。</li></ul></li><li>on demand computing -&gt; on demand mining（潜在危害）</li></ul></li></ul><h2 id="BTC-使用的脚本语言"><a href="#BTC-使用的脚本语言" class="headerlink" title="BTC 使用的脚本语言"></a>BTC 使用的脚本语言</h2><ul><li>基于栈的编程语言：很简单，只有一个堆栈</li></ul><h3 id="交易结构"><a href="#交易结构" class="headerlink" title="交易结构"></a>交易结构</h3><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_0280.jpg" alt="IMG_0280" style="zoom:35%"><p><strong>交易的输入</strong></p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_0281-9908278.jpg" alt="IMG_0281" style="zoom:38%"><p><strong>交易的输出</strong></p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_0282.jpg" alt="IMG_0282" style="zoom:55%"><h3 id="交易验证"><a href="#交易验证" class="headerlink" title="交易验证"></a>交易验证</h3><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_0262.jpg" alt="IMG_0262" style="zoom:36%"><ul><li>早期是将输入输出脚本拼接到一起执行</li><li>后面处于安全考虑，输入输出两者分别执行，都为非0(True)则成功</li></ul><h4 id="脚本形式"><a href="#脚本形式" class="headerlink" title="脚本形式"></a>脚本形式</h4><blockquote><p>注：下面的脚本中，省略了<code>OP_</code>前缀</p><ul><li>如CHECKSIG -&gt; OP_CHECKSIG；DUP -&gt; OP_DUP；</li></ul></blockquote><ol><li><p><strong>P2PK ，Pay to Public Key</strong></p><ul><li>input script<ol><li><strong>PUSHDATA(SIG)**：将输入里提供的</strong><code>签名</code>**压入栈</li></ol></li><li>output script<ol start="2"><li><strong>PUSHDATA(PubKey)**：将输出里提供的</strong><code>公钥</code>**压入栈</li><li><strong>CHECKSIG</strong>：将栈顶的两个元素弹出来，用公钥检查签名是否正确<ul><li>正确则返回True，验证通过，否则执行出错，交易是非法的</li></ul></li></ol></li></ul></li><li><p><strong>P2PKH，Pay to Public Key Hash</strong></p><ul><li>input script<ol><li><strong>PUSHDATA(SIG)**：将输入里提供的</strong><code>签名</code>**压入栈</li><li><strong>PUSHDATA(PubKey)**：将</strong><code>公钥</code>**压入栈</li></ol></li><li>output script<ol start="3"><li><strong>DUP</strong>：将栈顶的元素复制一遍<ul><li>栈顶多了一个**<code>公钥</code>**</li></ul></li><li><strong>HASH160</strong>：将栈顶元素弹出，取hash，再将此hash值压入栈<ul><li>此时栈顶是**<code>公钥的hash-1</code>**</li></ul></li><li><strong>PUSHDATA(PubKeyHash)**：将输出中提供的</strong><code>公钥的hash-2</code>**值压入栈<ul><li>此时栈顶有两个公钥的hash</li></ul></li><li><strong>EQUALVERIFY</strong>：弹出栈顶的两个元素，比较是否相等<ul><li>防止有人冒名顶替，用自己的公钥冒充收款人的公钥</li><li>相等的话栈顶的两个**<code>PubKeyHash</code>**就消失了</li></ul></li><li><strong>CHECKSIG</strong>：将栈顶的两个元素弹出来，用公钥检查签名是否正确<ul><li>正确则返回True，验证通过，否则执行出错，交易是非法的</li></ul></li></ol></li></ul><blockquote><p>区别：第二种没有在输出中直接给出收款人的公钥，而是给出公钥的hash。公钥则是在输入脚本中给出的，其他的操作都是为了验证正确性。</p><p>第二种更常用</p></blockquote></li><li><p><strong>P2SH，Pay to Script Hash</strong></p><blockquote><p><strong>采用BIP16的方案</strong></p><p>输出脚本不提供收款人公钥的hash，而是收款人提供的脚本的hash</p><ul><li>redeemScript：赎回脚本</li><li>常见应用场景：对多重签名的支持-防止私钥的泄露</li></ul></blockquote><p><strong>验证分两步：</strong></p><ul><li>input script要给出一些签名（数目不定）及一段序列化的redeemScript<ol><li>验证序列化的<strong>redeemScript</strong>是否与<strong>output script</strong>中的hash值匹配</li><li>将输入脚本中给出的序列化的<strong>redeemScript</strong>反序列化并执行<strong>redeemScript</strong>，验证<strong>input script</strong>中给出的签名是否正确</li></ol></li></ul><blockquote><p>此处脚本中redeemScript内容采用<strong>P2PK形式</strong></p></blockquote><ul><li><p><strong>第一阶段</strong></p><ul><li><p>input script</p><ol><li><p><strong>PUSHDATA(Sig)**：将输入的</strong><code>签名</code>**压入栈</p></li><li><p><strong>PUSHDATA(serialized redeemScript)**：将赎回脚本</strong><code>seriRS</code>**压入栈</p></li></ol></li><li><p>output script</p><ol start="3"><li><strong>HASH160</strong>：将栈顶元素**<code>seriRS</code>**弹出，取hash，再将此hash值压入栈<ul><li>此时栈顶为**<code>RSH-1</code>**</li></ul></li><li><strong>PUSHDATA(redeemScriptHash)**：将输出脚本中给出的hash值</strong><code>RSH-2</code>**压入栈<ul><li>栈顶为两个<strong>RSH</strong></li></ul></li><li><strong>EQUAL</strong>：比较栈顶的两个RSH是否相等<ul><li>相等的话栈顶的两个**<code>RSH</code><strong>就消失了，栈中只剩一个</strong><code>Sig</code>**</li></ul></li></ol></li></ul></li><li><p><strong>第二阶段</strong></p><ul><li>执行反序列化之后的redeemScript<ol><li><strong>PUSHDATA(PubKey)**：将</strong><code>公钥</code>**压入栈</li><li><strong>CHECKSIG</strong>：检查输入给出的**<code>签名</code>**的正确性</li></ol></li></ul></li></ul></li></ol><h4 id="redeemScript"><a href="#redeemScript" class="headerlink" title="redeemScript"></a>redeemScript</h4><ol><li><p>P2PK形式</p><ul><li>PUSHDATA(PubKey)：将**<code>公钥</code>**压入栈</li><li>CHECKSIG：验证栈顶的**<code>公钥</code><strong>和</strong><code>签名</code>**是否匹配</li></ul></li><li><p>P2PKH形式</p></li><li><p>多重签名形式 - 下面的P2SH实现多重签名</p><blockquote><p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_C6B93A3357A1-1.jpeg" alt="IMG_C6B93A3357A1-1" style="zoom:45%"> <img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_56F89D5B4A1F-1-9752549.jpeg" alt="IMG_56F89D5B4A1F-1" style="zoom:45%"></p><ul><li>输出脚本提供N个公钥和一个域值M，输入脚本只需要提供这N个签名中任意M个合法的签名就能通过验证<ul><li>**<code>CHECKMULTISIG</code>**：验证堆栈中是否有N个签名中的M个</li></ul></li></ul></blockquote></li></ol><p>1、<strong>P2SH实现多重签名</strong> - 现在普遍采用的形式</p><ul><li><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_0272.jpg" alt="IMG_0272" style="zoom:30%"></li><li><strong>本质</strong>：将复杂度从输出脚本转移到了输入脚本 -&gt; 赎回脚本里面</li><li>赎回脚本在输入里面，由<strong>收款人</strong>提供，输出脚本只需要提供赎回脚本的hash值即可<ul><li>实际应用中，收款人不需要公布多重签名的公钥hash值，直接提供赎回脚本的hash值就可以了。则收款人采用什么形式的多重签名就可以隐藏起来</li></ul></li></ul><p>2、<strong>Proof of Burn</strong></p><ul><li>特殊的输出脚本形式，是销毁比特币的方法</li><li>output script，被称为<code>provably Unspendable/Prunable Outputs</code><ul><li><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/IMG_0279.jpg" alt="IMG_0279" style="zoom:25%"></li><li>假如一个交易的input指向这个output，不论这个input里的input script如何设计，执行到<code>RETUEN</code>命令之后会直接返回false，不会执行后面的其他指令，所以这个output无法再被花出去，其对应的UTXO也就可以被剪枝了，无需保存</li></ul></li><li>应用场景<ol><li>一些小的币种(AltCoin，Alternative Coin)需要销毁一定数量的比特币来实现</li><li>向其中添加一些无法篡改的内容<ul><li>example - digital commitment，证明在某个时间知道某些事情：如将知识产权取hash之后存在<code>RETUEN</code>之后，之后可以证明你在这个时间知道某些事</li></ul></li></ol></li></ul><h2 id="fork-分岔"><a href="#fork-分岔" class="headerlink" title="fork, 分岔"></a>fork, 分岔</h2><p>state fork</p><p>forking attack</p><h1 id="以太坊-ETC"><a href="#以太坊-ETC" class="headerlink" title="以太坊 ETC"></a>以太坊 ETC</h1><h2 id="Consensus-Algorithm"><a href="#Consensus-Algorithm" class="headerlink" title="Consensus Algorithm"></a>Consensus Algorithm</h2><p>通过挖矿得到区块，算法分为一下两种</p><p>1、Ethash：及PoW，找nonce以生成区块</p><p>2、Clique：及PoA，投票选出权威节点Authority，由权威节点来验证区块的正确性</p><h1 id="Hyperledger-fabric"><a href="#Hyperledger-fabric" class="headerlink" title="Hyperledger fabric"></a>Hyperledger fabric</h1><ul><li>由IBM贡献的超级账本框架。它是一个利用现有成熟的技术来组合而成的一个区块链技术的实现。它是一种允许可插拔实现各种功能的的模块化架构。它具有强大的容器技术，来承载各种主流语言来编写的智能合约。</li><li>Fabric 是一个 Python (2.5-2.7) 的库和命令行工具，用来提高基于 SSH 的应用部署和系统管理效率<ul><li>一个让你通过 <strong>命令行</strong> 执行 <strong>无参数 Python 函数</strong> 的工具；</li><li>一个让通过 SSH 执行 Shell 命令更加 <strong>容易</strong> 、 <strong>更符合 Python 风格</strong> 的命令库（建立于一个更低层次的库）。</li></ul></li></ul><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><a class="link" target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/latest/getting_started.html">官方文档<i class="fas fa-external-link-alt"></i></a></p><p>系统：MacOS</p><p>Prerequisites - 先决条件</p><ul><li><strong>Homebrew</strong>：仅mac系统需要，用来管理下面所需要的软件包</li><li><strong>git</strong>：<strong>版本管理</strong>工具</li><li><strong>cURL</strong>：curl命令是个功能强大的<strong>网络工具</strong>，支持通过http、ftp等方式下载文件、上传文件</li><li><strong>Docker &amp; Docker-compose</strong>：一个开源的<strong>应用容器引擎</strong>，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化</li><li><strong>Go</strong>：Docker是基于go语言的<ul><li>(only required if you will be writing Go chaincode or SDK applications)</li></ul></li><li><strong>JQ</strong>：既JQuery，一个优秀的javascript类库<ul><li>(only required for the tutorials related to channel configuration transactions)</li></ul></li></ul><h3 id="Homebrew"><a href="#Homebrew" class="headerlink" title="Homebrew"></a>Homebrew</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> /bin/bash -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)</span>&quot;</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> brew --version</span></span><br><span class="line">Homebrew 3.0.4</span><br><span class="line">Homebrew/homebrew-core (git revision 89d933; last commit 2020-04-01)</span><br></pre></td></tr></table></figure><p><strong>问题</strong></p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/截屏2021-03-07 下午5.22.32.png" alt="截屏2021-03-07 下午5.22.32" style="zoom:50%"><ol><li>Error: Unknown command: cask<ul><li>Homebrew 2.5.x 之后删掉了<code>brew cask</code></li><li>直接使用<code>brew</code>，或者<code>brew --cask</code>即可</li></ul></li></ol><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/截屏2021-03-07 下午5.21.56.png" alt="截屏2021-03-07 下午5.21.56" style="zoom:50%"><ol start="2"><li><p>升级后核心不可用<code>homebrew-core is a shallow clone</code></p><ul><li><p>先按照提示执行<code>git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow</code></p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/截屏2021-03-07 下午7.57.58.png" alt="截屏2021-03-07 下午7.57.58" style="zoom:50%"></li><li><p>如果系统不支持<code>unshallow</code>，则删掉核心后再update</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> rm -rf /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/homebrew/homebrew-core</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> brew update</span></span><br></pre></td></tr></table></figure></li></ul></li></ol><h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> brew install git</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git --version</span></span><br><span class="line">git version 2.24.3 (Apple Git-128)</span><br></pre></td></tr></table></figure><h3 id="cURL"><a href="#cURL" class="headerlink" title="cURL"></a>cURL</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> brew install curl</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> curl --version</span></span><br><span class="line">curl 7.63.0 (x86_64-apple-darwin13.4.0) libcurl/7.63.0 OpenSSL/1.1.1b zlib/1.2.11 libssh2/1.8.0</span><br><span class="line">Release-Date: 2018-12-12</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><ul><li>Since Docker Desktop is a UI application on Mac, use <code>cask</code> to install it.</li></ul><p>Homebrew v2.x:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> brew cask install --appdir=<span class="string">&quot;/Applications&quot;</span> docker</span></span><br></pre></td></tr></table></figure><p>Homebrew v3.x:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> brew install --cask --appdir=<span class="string">&quot;/Applications&quot;</span> docker</span></span><br></pre></td></tr></table></figure><ul><li>Docker Desktop must be launched to complete the installation so be sure to open the application after installing it:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> open /Applications/Docker.app</span></span><br></pre></td></tr></table></figure><ul><li>Once installed, confirm the latest versions of both <code>docker</code> and <code>docker-compose</code> executables were installed.</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ docker --version</span><br><span class="line">Docker version 20.10.5, build 55c4c88</span><br><span class="line">$ docker-compose --version</span><br><span class="line">docker-compose version 1.28.5, build c4eb3a1f</span><br></pre></td></tr></table></figure><ul><li><p>docker镜像在国外，为了后续下载加速，配置文件将镜像换成国内的</p><ul><li>在<code>/etc/docker/daemon.json</code>文件中配置或者如下图所示在软件中配置：</li><li><code>&#123;&quot;registry-mirrors&quot;:[&quot;https://reg-mirror.qiniu.com/&quot;]&#125;</code></li></ul><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/截屏2021-03-07 下午9.55.31.png" alt="截屏2021-03-07 下午9.55.31" style="zoom:60%"></li></ul><h3 id="Go"><a href="#Go" class="headerlink" title="Go"></a>Go</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> brew install go</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> go version</span></span><br><span class="line">go version go1.16 darwin/amd64</span><br></pre></td></tr></table></figure><h3 id="JQ"><a href="#JQ" class="headerlink" title="JQ"></a>JQ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> brew install jq</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> jq --version</span></span><br><span class="line">jq-1.6</span><br></pre></td></tr></table></figure><p><strong>问题</strong>：</p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/截屏2021-03-08 下午1.26.23.png" alt="截屏2021-03-08 下午1.26.23" style="zoom:50%"><ol><li>python版本问题<ul><li>按照给出的指令顺序操作</li><li><code>--overwrite</code> 表示强制</li></ul></li></ol><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/截屏2021-03-08 下午1.32.00.png" alt="截屏2021-03-08 下午1.32.00" style="zoom:50%"><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p><strong>基本结构</strong>：</p><ul><li><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/截屏2021-03-04 下午4.52.42-4848273.png" alt="截屏2021-03-04 下午4.52.42" style="zoom:40%"></li></ul><p><strong>资产</strong></p><ul><li>理解为任何具有货币价值的东西，它们都可以通过网络进行交易，无论是有形资产还是无形资产都属于资产</li><li>资产在Fabric中以<code>键-值对集合</code>的形式存在，在通道（Channel）中各本地账本可以对其状态提交变更事物</li><li>资产可以用<strong>二进制</strong>或<strong>JSON</strong>形式表示</li></ul><h3 id="区块结构-1"><a href="#区块结构-1" class="headerlink" title="区块结构"></a>区块结构</h3><ol><li><strong>区块头</strong>：包含三个属性（<strong>区块号</strong>、<strong>当前区块哈希</strong>、<strong>前一个区块的哈希</strong>），当一个区块被创建时写入。</li><li><strong>区块数据</strong>：包含的是<strong>排序后的交易列表</strong>。当区块被ordering service创建时写入。</li><li><strong>区块元数据</strong>：包括区块的<strong>写入时间</strong>，以及<strong>区块写入者的证书</strong>、<strong>公钥</strong>和<strong>签名。</strong></li></ol><h3 id="交易"><a href="#交易" class="headerlink" title="交易"></a>交易</h3><p>在fabric中指的就是对<strong>链代码（即智能合约）的操作</strong>，交易分为两种</p><ol><li><p><strong>部署交易（deploy transaction）</strong>：</p><ul><li>指的是<strong>创建新的链代码</strong>，并且用一个程序作为参数，当一个部署交易成功执行时，链代码就被安装到区块链上了。</li></ul></li><li><p><strong>调用交易（invoke transaction）</strong>：</p><ul><li><p>指的是<strong>运行链代码</strong>，链代码执行时可能会修改相应的状态并返回输出。下图是一个交易的详细结构：</p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/15873283-087e0d4d80b57ca1.png" alt="15873283-087e0d4d80b57ca1" style="zoom:70%"><ul><li><strong>交易头</strong>：包含交易的元数据，如<strong>链码名称、版本</strong>等</li><li><strong>交易签名</strong>：包含由客户端应用程序创建的<strong>加密签名</strong>，作用是判断交易是否被篡改</li><li><strong>交易提案</strong>：作用是对由应用程序提供给智能合约的输入参数进行编码。当智能合约运行时，提案<strong>负责将参数传递过去</strong></li><li><strong>交易响应</strong>：是<strong>智能合约的输出</strong>，包含的是世界状态在交易前后的值，以读写集的形式展示。</li></ul></li></ul></li></ol><h4 id="交易流程"><a href="#交易流程" class="headerlink" title="交易流程"></a>交易流程</h4><p>前提假设是各节点已经提前颁发好证书，且已正常启动，并加入已经创建好的通道。此流程介绍的是在已经实例化了的链码通道上从发起一个<strong>调用交易到最终结账的全过程</strong>。</p><ol><li>提交交易提案<br>应用程序（客户端节点）构造好<strong>交易提案（交易提案中包含本次交易要调用的合约标识、合约方法和参数信息以及客户端签名等）</strong>请求后，根据背书策略选择背书节点执行交易提案并进行背书签名。背书节点是链代码中背书策略指定的节点。正常情况下背书节点执行后的结果是一致的，只有背书节点对结果的签名不一样。</li><li>模拟执行提案并进行背书<br>背书节点在收到交易提案后会进行一些验证，验证通过后，<strong>背书节点会根据当前账本数据模拟执行链码中的业务逻辑并生成读写集（RwSet）。</strong>模拟执行时不会更新账本数据。<strong>然后背书节点对这些读写集进行签名生成提案响应（proposal response）</strong>，然后返回给应用程序。</li><li>收集交易的背书（返回模拟执行结果）<br>应用程序收到proposal response后会对背书节点的签名进行验证<strong>（所有节点接收到任何消息时都需要先验证消息的合法性）。</strong>如果链码只进行账本查询操作，应用程序只需要检查查询响应，并不会将交易提交给排序服务节点。如果链码对账本进行了invoke操作，则需要提交交易给排序服务进行账本更新（提交前会判断背书策略是否满足）。</li><li>构造交易请求并发送给排序服务节点<br>应用程序接收到所有背书节点的签名后，<strong>根据背书签名调用SDK生成交易，并广播给排序服务节点。</strong>其中生成交易的过程很简单，只需要确认所有背书节点的执行结果完全一致，再将交易提案、提案响应和背书签名打包生成交易即可。</li><li>排序服务节点对交易进行排序并生成区块<br>排序服务节点接收到网络中所有通道发出的交易信息，读取交易信封获取通道名称，按各个通道上交易的接收时间顺序对交易信息进行排序（多通道隔离），生成区块。（在这个过程中，排序服务节点不会关心交易是否正确，只是负责排序和打包。交易的有效性在第7步进行验证）</li><li>排序服务节点广播区块给主节点<br>排序服务节点生成区块后会广播给通道上不同组织的主节点。</li><li>记账节点验证区块内容并写入到账本<br>所有的peer节点都是记账节点，记录的是节点已加入通道的账本数据。记账节点接收到的排序服务节点生成的区块后，会验证区块交易的有效性，然后提交到本地账本并产生一个生成区块的事件，监听区块事件的应用程序会进行后续的处理。（如果接收的是配置区块，则会更新缓存的配置信息）</li><li>主节点在组织内部同步最新的区块<br>如果交易是无效的，也会更新区块，但不会更新世界状态。（区块存储的是操作语句，而世界状态存储的是被处理的数据）</li></ol><h3 id="节点-1"><a href="#节点-1" class="headerlink" title="节点"></a>节点</h3><p>区块链的通信实体，是一个逻辑概念，不同类型的多个节点可以运行在同一个物理服务器上。</p><ol><li><p><strong>客户端节点</strong>：客户端必须连接到某一个<strong>peer节点</strong>或<strong>排序服务节点</strong>上才能与区块链网络进行通信。</p><ul><li>客户端<strong>向背书节点</strong>（endorser）<strong>提交交易提案</strong>（transaction proposal），当收集到足够背书后，<strong>向排序服务节点广播交易提案</strong>，进行排序，生成区块。</li></ul></li><li><p><strong>普通节点 peer</strong>：peer节点根据所承担的角色又可以分为记账节点（committer）、背书节点（endorser）、主节点（leader）和锚节点（anchor）。</p><hr><ul><li><strong>记账节点 Committer</strong>：<ul><li>所有的peer节点都是记账节点（committer）</li><li>负责<strong>验证排序服务节点区块里的交易</strong>，<strong>维护状态和总账（Ledger）的副本。</strong></li><li>该节点会定期从orderer节点获取包含交易的区块，在对这些区块进行核发验证之后，会把这些区块加入到区块链中。</li><li>committer节点无法通过配置文件配置，<strong>需要在当前客户端或者命令行发起交易请求的时候手动指定相关的committer节点</strong>。</li><li>记账节点可以有多个。</li></ul></li><li><strong>背书节点 endorser</strong>：<ul><li>部分节点还会<strong>执行交易并对结果进行签名背书</strong>，充当背书节点（endorser）的角色。</li><li>背书节点是动态的角色，是与具体链码绑定的。每个链码在实例化的时候都会设置背书策略，指定哪些节点对交易背书后交易才是有效的。并且只有应用程序向它发起交易背书请求的时候才是背书节点，其他时候都是普通的记账节点，只负责验证交易并记账。</li><li>背书节点也无法通过配置文件指定，而是<strong>由发起交易请求的客户端指定</strong>。</li><li>背书节点可以有多个。</li></ul></li><li><strong>锚节点 anchor</strong>：peer节点还可以是锚节点（anchor peer）<ul><li>锚节点主要<strong>负责代表组织和其他组织进行信息交换。</strong>每个组织都有一个锚节点，锚节点对于组织来说非常重要，如果锚节点出现问题，当前组织就会与其他组织失去联系。</li><li>锚节点的配置信息是<strong>在configtxgen模块的配置文件configtx.yaml中配置</strong>的。</li><li>锚节点只能有一个。</li></ul></li><li><strong>主节点 leader</strong>：peer节点还可以是主节点（leader peer）<ul><li>能<strong>与排序服务节点通信</strong>，<strong>负责从排序服务节点获取最新的区块并在组织内部同步。</strong></li><li>主节点在整个组织中只能有一个。</li></ul></li></ul><hr></li><li><p><strong>排序服务节点 orderer</strong>：接收包含背书签名的交易，对未打包的交易进行排序生成区块，广播给peer节点。</p><ul><li>排序服务提供的是原子广播，保证同一个链上的节点接收到相同的信息，并且有相同的逻辑顺序。</li></ul></li><li><p><strong>CA节点：</strong>fabric1.0的证书颁发机构，由服务器和客户端组成。</p><ul><li>CA节点接收客户端的注册申请，返回注册密码用于用户登录，以便获取身份证书。</li><li>区块链上的所有操作都需要验证用户身份。</li></ul></li></ol><p><strong>系统逻辑结构</strong></p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/15873283-70ae13534abcc893.png" alt="15873283-70ae13534abcc893" style="zoom:80%"><ul><li></li></ul><h2 id="智能合约"><a href="#智能合约" class="headerlink" title="智能合约"></a>智能合约</h2><ul><li><strong>chaincode：</strong> 链码，Fabric的<strong>智能合约</strong>写在链码里并在区块链外部应用程序要和账本发生交易的时候被外部应用程序调用。<ul><li>在大多数情况下，链码只和账本的数据库组件（<strong>世界状态</strong>）交互，而不和交易日志交互。</li></ul></li><li><strong>账本</strong>：Fabric有一个账本子系统包含两个组件：<strong>世界状态和交易日志</strong>。每一个参与者有一份他们参与的每个Fabric网络的账本的副本。<ul><li>世界状态组件描述了一个给定时间点的账本状态。它是账本的数据库，存储的是<strong>账本当前值</strong>。</li><li>交易日志组件记录所有导致世界状态当前值的交易。<strong>它是世界状态的更新历史</strong>。这样，账本就是世界状态数据库和交易日志历史的组合体。</li></ul></li></ul><p><strong>世界状态</strong></p><ul><li>版本号：从0开始，每当状态更新时版本号就递增。状态更新时会首先检查版本号，以确保当前状态的版本与背书时的版本一致（避免并发更新）</li></ul><h2 id="共识机制"><a href="#共识机制" class="headerlink" title="共识机制"></a>共识机制</h2><p>Fabric区块链的网络节点本质上是<strong>互相复制的状态机</strong>，节点之间需要保持相同的账本状态。为了实现分布式节点的一致性，各个节点需要<strong>通过共识过程，对账本状态的变化达成一致性的认同。</strong></p><p><strong>共识过程</strong></p><img src="/2021/03/04/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BA%94%E7%94%A8/15873283-02a9f2f1bb4d0bfd.png" alt="15873283-02a9f2f1bb4d0bfd" style="zoom:50%"><ol><li><strong>背书（endorsement）阶段</strong><ul><li><strong>背书节点</strong>对客户端发来的交易提案进行合法性校验，然后模拟执行链码得到交易结果，最后根据设定的背书逻辑判断是否支持该交易提案。如果背书逻辑决定支持交易提案，会把交易提案签名后发回给客户端。</li><li>客户端通常需要根据链码的<strong>背书策略</strong>，向一个或者多个成员的背书节点发出背书请求。背书策略会定义需要哪些节点背书交易才有效，例如需要5个成员的背书节点中至少3个同意；或者某个特殊身份的成员支持等。</li><li>客户端只有在收集<strong>足够多</strong>的背书节点的交易提案签名，交易才能被视为有效。</li></ul></li><li><strong>排序（ordering）阶段</strong><ul><li>由<strong>排序服务节点对</strong>交易进行排序，确定交易之间的时序关系。排序服务把一段时间内收到的交易进行排序，然后把排序后的批量交易<strong>打包成数据块</strong>（区块），再把区块<strong>广播</strong>给通道中的成员。</li><li>采用<strong>排序共识</strong>方式，各个成员收到的是一组发生顺序相同的交易，从而保证了所有节点的<strong>数据一致性。</strong>目前，Hyperledger Fabric有三种交易排序算法：Solo、Kafka、SBFT。<ol><li><strong>Solo</strong>：只有一个排序服务节点负责接收交易信息并排序，是最简单的一种排序算法，一般用于开发测试环境中。Solo共识模式属于<strong>中心化的处理</strong>方式，<strong>不支持</strong>拜占庭容错。</li><li><strong>Kafka</strong>：Kafka是Apache的一个开源项目，主要提供分布式的消息处理／分发服务，每个Kafka集群由多个服务节点组成。Hyperledger Fabric利用Kafka对交易信息进行排序处理，提供高吞吐、低延时的处理能力，并且在集群内部<strong>支持节点故障容错，但不支持拜占庭容错。</strong></li><li><strong>SBFT</strong>：简单拜占庭算法，<strong>支持拜占庭容错的可靠排序算法，包括容忍节点故障以及一定数量的恶意节点。</strong></li></ol></li><li>排序服务是共识机制中重要的一环，所有交易都要通过排序服务的排序才可以达成全网共识，因此排序服务要避免成为网络上的性能瓶颈。</li></ul></li><li><strong>校验（Validation）阶段</strong><ul><li>节点对排序后的交易进行一系列的检验，包括<strong>交易数据的完整性</strong>检查、是否<strong>重复交易</strong>、背书签名<strong>是否符合背书策略</strong>的要求、交易的<strong>读写集是否符合MVCC</strong>（Multiversion Concurrency Control，多版本并发控制）的校验等。</li><li>当交易通过了所有校验后，将被标注为合法并写入账本中。因为所有的确认节点都按照相同的顺序检验交易，并且把合法的交易依次写入账本中，因此不同确认节点的状态能够始终保持一致。</li></ul></li></ol><h2 id="包"><a href="#包" class="headerlink" title="包"></a>包</h2><h1 id="Conflux"><a href="#Conflux" class="headerlink" title="Conflux"></a>Conflux</h1><p>Conflux共识机制是在比特币源代码基础上实现的。</p><p>Conflux的框架和比特币的矿机类似</p><ul><li>GossipNetwork：实现P2P网络交互</li><li>节点：维护TxPool，生成区块（Block Generator），以及维护区块状态</li></ul><p>GHost协议</p><p>epoch</p></div><div class="post-copyright-info"><div class="article-copyright-info-container"><ul><li>Post title：区块链应用</li><li>Post author：Wei Jieyang</li><li>Create time：2021-03-04 14:48:09</li><li>Post link：https://jieyang-wei.github.io/2021/03/04/区块链应用/</li><li>Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.</li></ul></div></div><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="/2021/03/07/fabric/"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">fabric</span> <span class="post-nav-item">Prev posts</span></span></a></div><div class="article-next"><a class="next" rel="next" href="/2021/03/04/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"><span class="title flex-center"><span class="post-nav-title-item">分布式系统</span> <span class="post-nav-item">Next posts</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div></div></div></main></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2020</span> - 2021 <i class="fas fa-heart icon-animate"></i> <a href="/">Wei Jieyang</a></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item"><span id="busuanzi_container_site_uv">Visitor Count <span id="busuanzi_value_site_uv"></span>&ensp; </span><span id="busuanzi_container_site_pv">Totalview <span id="busuanzi_value_site_pv"></span></span></div><div class="theme-info info-item">Powered by <a target="_blank" href="https://hexo.io">Hexo</a> | Theme <a class="theme-version" target="_blank"></a></div></div></footer></div></div></main><div class="sidebar-tools"><div class="tools-container"><ul class="tools-list"><li class="search popup-trigger"><i class="fas fa-search"></i></li><li class="tools-item page-aside-toggle"><i class="fas fa-outdent"></i></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-expand-width flex-center"><i class="fas fa-arrows-alt-h"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-top flex-center"><i class="fas fa-arrow-up"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="tools-ul-1"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li></ul></div></div><aside class="page-aside"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#crypto-currency%EF%BC%8C%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81"><span class="nav-number">1.</span> <span class="nav-text">crypto-currency，加密货币</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81-BTC"><span class="nav-number">2.</span> <span class="nav-text">比特币 BTC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="nav-number">2.1.</span> <span class="nav-text">密码学</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-crypto-graphic-hash-function"><span class="nav-number">2.1.1.</span> <span class="nav-text">1. crypto graphic hash function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%AD%BE%E5%90%8D"><span class="nav-number">2.1.2.</span> <span class="nav-text">2. 签名</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BTC-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-number">2.2.</span> <span class="nav-text">BTC 数据结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#hash-point"><span class="nav-number">2.2.1.</span> <span class="nav-text">hash point</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81"><span class="nav-number">2.3.</span> <span class="nav-text">数字货币</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BTC%E8%A7%A3%E5%86%B3%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96%E7%9A%84%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%8F%91%E8%A1%8C%E9%97%AE%E9%A2%98"><span class="nav-number">2.3.1.</span> <span class="nav-text">BTC解决去中心化的数字货币发行问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">数据结构</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8C%BA%E5%9D%97%E7%BB%93%E6%9E%84"><span class="nav-number">2.3.1.1.1.</span> <span class="nav-text">区块结构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8A%82%E7%82%B9"><span class="nav-number">2.3.1.1.2.</span> <span class="nav-text">节点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Consensus-in-BitCoin%EF%BC%8C%E6%AF%94%E7%89%B9%E5%B8%81%E5%85%B1%E8%AF%86"><span class="nav-number">2.3.1.2.</span> <span class="nav-text">Consensus in BitCoin，比特币共识</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BTC%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.3.1.3.</span> <span class="nav-text">BTC系统实现</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#transaction-based-ledger%EF%BC%8C%E5%9F%BA%E4%BA%8E%E4%BA%A4%E6%98%93%E7%9A%84%E8%B4%A6%E6%9C%AC%E6%A8%A1%E5%BC%8F"><span class="nav-number">2.3.1.3.1.</span> <span class="nav-text">transaction-based ledger，基于交易的账本模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Bernoulli-trial"><span class="nav-number">2.3.1.3.2.</span> <span class="nav-text">Bernoulli trial</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BTC%E7%BD%91%E7%BB%9C"><span class="nav-number">2.3.1.4.</span> <span class="nav-text">BTC网络</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%96%E7%9F%BF"><span class="nav-number">2.4.</span> <span class="nav-text">挖矿</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%96%E7%9F%BF%E9%9A%BE%E5%BA%A6"><span class="nav-number">2.4.1.</span> <span class="nav-text">挖矿难度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%BE%E5%BA%A6%E8%B0%83%E6%95%B4"><span class="nav-number">2.4.2.</span> <span class="nav-text">难度调整</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87"><span class="nav-number">2.4.3.</span> <span class="nav-text">设备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%BF%E6%B1%A0"><span class="nav-number">2.4.4.</span> <span class="nav-text">矿池</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BTC-%E4%BD%BF%E7%94%A8%E7%9A%84%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80"><span class="nav-number">2.5.</span> <span class="nav-text">BTC 使用的脚本语言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E6%98%93%E7%BB%93%E6%9E%84"><span class="nav-number">2.5.1.</span> <span class="nav-text">交易结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E6%98%93%E9%AA%8C%E8%AF%81"><span class="nav-number">2.5.2.</span> <span class="nav-text">交易验证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E5%BD%A2%E5%BC%8F"><span class="nav-number">2.5.2.1.</span> <span class="nav-text">脚本形式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#redeemScript"><span class="nav-number">2.5.2.2.</span> <span class="nav-text">redeemScript</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fork-%E5%88%86%E5%B2%94"><span class="nav-number">2.6.</span> <span class="nav-text">fork, 分岔</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A5%E5%A4%AA%E5%9D%8A-ETC"><span class="nav-number">3.</span> <span class="nav-text">以太坊 ETC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Consensus-Algorithm"><span class="nav-number">3.1.</span> <span class="nav-text">Consensus Algorithm</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hyperledger-fabric"><span class="nav-number">4.</span> <span class="nav-text">Hyperledger fabric</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">4.1.</span> <span class="nav-text">安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Homebrew"><span class="nav-number">4.1.1.</span> <span class="nav-text">Homebrew</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Git"><span class="nav-number">4.1.2.</span> <span class="nav-text">Git</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cURL"><span class="nav-number">4.1.3.</span> <span class="nav-text">cURL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker"><span class="nav-number">4.1.4.</span> <span class="nav-text">Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Go"><span class="nav-number">4.1.5.</span> <span class="nav-text">Go</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JQ"><span class="nav-number">4.1.6.</span> <span class="nav-text">JQ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">4.2.</span> <span class="nav-text">基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%BA%E5%9D%97%E7%BB%93%E6%9E%84-1"><span class="nav-number">4.2.1.</span> <span class="nav-text">区块结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E6%98%93"><span class="nav-number">4.2.2.</span> <span class="nav-text">交易</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%A4%E6%98%93%E6%B5%81%E7%A8%8B"><span class="nav-number">4.2.2.1.</span> <span class="nav-text">交易流程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%82%E7%82%B9-1"><span class="nav-number">4.2.3.</span> <span class="nav-text">节点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="nav-number">4.3.</span> <span class="nav-text">智能合约</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6"><span class="nav-number">4.4.</span> <span class="nav-text">共识机制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%85"><span class="nav-number">4.5.</span> <span class="nav-text">包</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conflux"><span class="nav-number">5.</span> <span class="nav-text">Conflux</span></a></li></ol></div></div></aside><div class="image-viewer-container"><div class="img-box"><img src=""></div></div></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fas fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/code-copy.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.0.4/source/js/toc.js"></script></body></html>